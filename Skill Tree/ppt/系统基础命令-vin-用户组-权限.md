## Linux常用命令

## 基础命令

### **linux 命令格式**

    linux 命令格式
	命令名 + 空格 + 参数
	ls -al /tmp


    介绍ls命令
    具体介绍命令格式，ls为什么可以直接用 
    因为它有没人的操作，而ping等命令则没有

### **开关机**

	重启 reboot 
	关机 shutdown halt  poweroff   
	退出 logout  exit

    几种系统模式 init
	--run level 0 :关机
	--run level 3 :纯文本模式
	--run level 6 :重新启动
    init 0 关机
    init 6 重启

shutdown -h now  实际执行的命令是 halt 
shutdown -r 实际执行的是reboot

### **文件读写操作**

    新建文件
        touch 新建文件
            touch /tmp/hello.txt
        mkdir 新建文件夹
            mkdir hello
    删除文件
        rm 删除文件
            rm hello.txt
        rmdir 删除文件夹
            rm hello

#### **带领操作**
    新建文件，目录不存在，引入mkdir命令
    mkdir新建文件夹

    同时 mkdir -p 自动逐级建立文件夹

    删除一个简单的文件
    删除一个文件夹，文件夹内含有文件，

    使用 -r 参数逐级一个一个删除文件夹内容

    使用 -f 参数，不提示直接删除
    建立快照，测试rm -rf /  ****修改

### **文件查看移动操作**


    复制移动
        cp  复制文件或文件夹到指定的位置
        mv  移动文件或文件夹到指定的位置
    查看文件
        cat 显示一个文件的内容
            cat /etc/passwd
        more  显示一个文件的内容，并且可控
            more /etc/yum.conf
        head  显示一个文件的前几行 
            head /etc/yum.conf
        tail  显示文件的后几行，并且可以动态显示
            tail /etc/yum.conf

        tail -f 动态显示文件最后几行可以用来调试日志

* 直接自己建立文件，里面内容

### **搜索**

	find 全盘查找文件
	grep 全盘所有的文件中查找某些字符，或者在某个文件中查找
	whereis 查找某个命令所在位置，
    which 找查找当前用户的命令

    可以自学awk和sed

    

### **快捷键**

    Linux系统中一些快捷键
	强行停止 ctrl + c
	退出shell=exit ctrl + d
	清屏  ctrl + l
	后台运行 ctrl + x
	时间 date 

### **介绍 / 目录下所有文件夹**


    /bin  放置可执行文件的目录；
    /dev 任何设备与周边设备都是以文件的型态存在于这个目录当中；
    /media放置的就是可移除的设备；
    /opt第三方协力软件放置的目录；
    /tmp暂时放置文件的地方；
    /home使用者主文件夹；
    /root系统管理员（root）的主文件夹；
    /proc虚拟文件系统；

	/etc Linux系统中配置文件几乎都放置在这个目录内；
	/usr usr是Unix Software Resource的缩写，Unix操作系统软件资源；
	/var var目录主要针对常态性变动的文件；


* /etc，/usr，/var是重要的目录。


### **路径**

相对路径绝对路径：

	绝对路径：由根目录（/）开始写起的文件名或目录名称， 例如 /home/dmtsai/.bashrc；
	相对路径：相对于目前路径的文件名写法。 例如 ./home/dmtsai 或 ../../home/dmtsai/ 等等。反正开头不是 / 就属于相对路径的写法
* 快捷路径
    
    . 当前目录
    
    .. 上一级目录
    
    ~ 用户家目录


##  vim编辑器

    之前简单的用过vi编辑器，修改了网卡的配置文件。
    还有没有印象

### **几种操作**

    Cp一个系统文件，

    vim编辑器三种模式


![1][1]

### **从命令行转换到插入**

    切换到插入模式：
	i, I 	进入插入模式(Insert mode)：i 为『从目前光标所在处插入』， I 为『在目前所在行的第一个非空格符处开始插入』
	a, A 	进入插入模式(Insert mode)：a 为『从目前光标所在的下一个字符处开始插入』， A 为『从光标所在行的最后一个字符处开始插入』。
	o, O 	进入插入模式(Insert mode)：这是英文字母 o 的大小写。o 为『在目前光标所在的下一行处插入新的一行』； O 为在目前光标所在处的上一行插入新的一行！

### **从命令行到末行模式**

    使用 : 来切换

    set nu 设置行号
	set nonu 删除行号
	w 保存内容
	wq 保存内容并且退出编辑器
	q! 不保存内容直接退出编辑器

### **从插入或者末行到命令行模式**

    esc键，任何地方切换到命令行模式
    命令行模式—搜索：
	    /word 	向光标之下寻找一个名称为 word 的字符串。
	    n 	这个 n 是英文按键。代表重复前一个搜寻的动作。	
	    :%s/word1/word2/g 	寻找 word1 这个字符串，并将该字符串取代为 word2 。

    命令行模式—删除，复制粘贴：
	    x, X		在一行字当中，x 为向后删除一个字符 ， X 为向前删除一个字符
	    dd	删除游标所在的那一整行。    
	    yy 	复制游标所在的那一行。
	    p, P		p 为将已复制的数据在光标下一行贴上，P 则为贴在游标上一行。
	    u	复原前一个动作。



## 下午课程

## 用户和组

### **用户如何登录：**

	我们登陆 Linux 主机的时候，输入的是我们的帐号，但是其实 Linux 主机并不会直接认识你的“帐号名称”的，他仅认识 ID。由于计算机仅认识 0 与 1，所以主机对于数字比较有概念的；至于帐号只是为了让人们容易记忆而已。 而你的 ID 与帐号的对应就在 /etc/passwd 当中。
	/etc/passwd 存储用户信息
    引入/etc/passwd

![2][2]

### **如何认证用户**


    当你输入完用户名之后，需要输入密码，系统会判断你的密码收否正确，它使用的是/etc/shadow这个文件，利用用户的id来找到你的密码。	 
	/etc/shadow  存储用户密码信息
    引入/etc/shadow

![3][3]

### **用户命令**

	useradd 新建用户组
	userdel 删除用户组
	usermod 修改用户所属组

	passwd 修改用户密码
	su 切换用户
#### **带领操做**
 * >   添加用户，查看家目录，查看passwd文件，设置密码，查看shadow文件，切换用户
    删除用户，查看家目录，查看passed文件，查看shadow文件。
    讲解文件中每一个部分对应的是什么
    新建用户a，b

### **详解usermod**
* 重要

    usermod [-g <群组>][-G <群组>][-l <帐号名称>][-s <shell>][-u <uid>][用户帐号]
    参数说明：

        -g<群组> 　修改用户所属的群组。
        -G<群组> 　修改用户所属的附加群组。
        -l<帐号名称> 　修改用户帐号名称。
        -L 　锁定用户密码，使密码无效。
        -s<shell> 　修改用户登入后所使用的shell。
        -u<uid> 　修改用户ID。
        -U 　解除密码锁定。



###  **用户管理**

    当你的电脑中有多个用户的时候该怎么区分呢？组是为了方便管理系统中多个用户
	/etc/group 存储用户组信息
    引入/etc/group

![4][4]

### **组的操作**

    groupadd 新建用户组
    groupdel 删除用户组
    groupmod 修改组名

## **文件权限**

## 基础概念先讲
### **几种文件类型**

    [ d ]则是目录；
    [ - ]则是文件；
    [ l ]则表示为链接文档(link file)；


###  **用户和组的关系**
    用户和组之间有什么联系？

![5][5]

    一个用户可以属于多个组
	一个组里面可以有多个用户
	一个用户只有属于这个组之后，才可以操作属于这个组的内容。
	root用户拥有整个系统所有的权限。


* 为什么要了解组，是为了权限。
* 因为linux系统对权限的控制比较严格，方便大家以后进行渗透




### **读写执行权限：**
读写执行权限：
	其中，第1、4、7位表示读权限，如果用"r"字符表示，则有读权限，如果用"-"字符表示，则没有读权限；第2、5、8位表示写权限，如果用"w"字符表示，则有写权限，如果用"-"字符表示没有写权限；第3、6、9位表示可执行权限，如果用"x"字符表示，则有执行权限，如果用"-"字符表示，则没有执行权限

![7][6]

### **修改文件权限**
	rwx在系统中对应一个个的值，
	r-4，w-2，x-1

	chown 修改当前文件或文件夹的所属用户

 	chown root:root /tmp/tmp1
	chown -R root:root /tmp/tmp1


    chmod 修改当前文件或文件夹的权限
    语法：chmod [who] [+ | - | =] [mode] 文件名
    命令中各选项的含义为：    
        操作对象who可是下述字母中的任一个或者它们的组合：
        u 表示“用户（user）”，即文件或目录的所有者。
        g 表示“同组（group）用户”，即与文件属主有相同组ID的所有用户。
        o 表示“其他（others）用户”。
        a 表示“所有（all）用户”。它是系统默认值。 
        操作符号可以是： 　　
        + 添加某个权限。
        - 取消某个权限。
        = 赋予给定权限并取消其他所有权限（如果有的话）。

*    把4 2 1和chmod联合起来
*    使用命令 chmod 755 index.php

## 再讲文件文件夹的权限
### **对于文件的rwx**

    读写执行rwx
	r可以读取显示显示文件内容，w可以向文件内写入删除内容，x可以运行这个文件。

#### **带领操做**
* 使用chmod命令，把一个文件修改权限
    没有r，没有 w，没有x三种情况


### **对于目录的rwx**

	读写执行rwx
	r可以显示文件夹的结构，w可以在文件夹里添加删除文件，x可以进入到文件夹。

#### **带领操做**
* 把一个文件夹修改权限，没有r，没有w，没有x

*  带领完成后，让自己操作

*    使用命令修改文件和文件夹的权限分别少一个权限，少一个权限后会发生什么情况。

## 讲用户和用户组对应的权限
### **文件所属**

    第0位确定文件类型，
    第1-3位确定属主（该文件的所有者）拥有该文件的权限。
	第4-6位确定属组（所有者的同组用户）拥有该文件的权限，
	第7-9位确定其他用户拥有该文件的权限。
* 介绍什么是文件所属用户，所属组，其他用户

![6][6]

#### **带领操做**
* 引入用户组与通过之前建立的用户，切换用户后
*    打开文件测试
*    使用a账户建立文件，
*    三个文件，用chmod改权限
*    分别少一个权限，看看操作有什么不同，再来一个777权限的


 *   使用a账户建立文件夹
 *   a1 771  a2 774  a3 772
*    在文件夹内放入文件 777
*    使用b账户访问a1，a2，a3目录。

*    把b加入a组，修改组的权限，对应文件和文件夹分别少一个权限

*    再使用b操作文件和文件夹


### **在以后渗透中会遇到的一些命令**

    渗透中常用命令
	whoami  查看当前用户
	tar  压缩和解压文件
	netstat  查看网络状态
	nslookup 查看dns信息
	ps 查看运行的程序
	top  实时查看运行的程序
	service  使用service控制服务启动关闭
	curl  来获取网页，可以使用输出重定向来下载文件
	wget  下载文件

* 主要是Whoami  uname  tar  netstat  ps   service  curl


## **实验**

### **实验环境**

centos6.5

### **实验内容**

* 建立用户 :
	
	在系统中建立用户两个apache和xiaoming；让小明加入到root组中。
    分别设置两个用户的家目录，apache没有家目录，xiaoming有家目录为/home/xiaoming，并且让apache不可以登录系统。


* 文件权限:
	
	用xiaoming账户登录系统，在/var/www/html中建立一个文件index.php；
	在里面写入一段代码：
	<?php
		phpinfo();
	？>
	让apapche用户对这个文件有rx权限。别的用户没有wx权限。

### **实验目的**

    了解用户和权限。
    做这个实验可以了解到之后搭建lamp环境。

### **实验可能遇到的问题**

    不知道如何禁止登录，可以使用两种办法
    1. 让密码无效
    2. 修改登录后的shell为/sbin/nologin


    apache用户如何拥有权限，而其他用户没有权限
    apache用户可以添加到xiaoming用户组里，index.php属于xiaoming，设置组权限和其他用户权限。


[1]:./image/1.png
[2]:./image/2.png
[3]:./image/3.png
[4]:./image/4.png
[5]:./image/5.png
[6]:./image/6.png
